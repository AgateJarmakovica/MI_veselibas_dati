# =====================================================================
# Universal AI-Driven Data Quality Rules Configuration (rules.yml)
# ---------------------------------------------------------------------
# Project: healthdq-ai
# Author: Agate Jarmakoviča
# Version: 2.0
# Date: 2025-10-30
#
# Purpose:
#   Define a hybrid human + AI system for automated discovery,
#   validation, and improvement of data quality across any dataset.
#
# Methodology:
#   Based on FAIR and Data-Centric AI principles, integrating:
#     - Precision  → semantic and logical validity
#     - Completeness → missingness detection and AI-based imputation
#     - Reusability → harmonization and semantic alignment
#
# References:
#   - Wang & Strong (1996) — Data Quality Framework
#   - Batini & Scannapieco (2016) — Data and Information Quality
#   - Data-Centric AI Principles (Ng, 2023)
#   - Human-in-the-Loop Design (Amershi et al., 2014)
# =====================================================================

metadata:
  author: "Agate Jarmakoviča"
  project: "healthdq-ai"
  version: "2.0"
  created: "2025-10-30"
  description: >
    Adaptive, AI-assisted rule configuration enabling automatic
    data quality learning and evaluation for diverse datasets.

# ---------------------------------------------------------------------
# GENERAL MODEL SETTINGS
# ---------------------------------------------------------------------
model:
  name: "healthdq-intelligence-layer"
  enable_self_learning: true
  enable_schema_discovery: true
  enable_cross_dataset_learning: true
  feedback_mode: "HITL"    # Human-in-the-Loop feedback integration

# ---------------------------------------------------------------------
# RULE GENERATION STRATEGY
# ---------------------------------------------------------------------
rule_generation:
  enabled: true
  based_on:
    - schema_structure       # detects column names, types, value ranges
    - statistical_discovery  # finds patterns, min/max, uniqueness
    - semantic_similarity    # compares column meaning to known concepts
  thresholds:
    correlation: 0.8
    similarity: 0.75
  max_rules_per_column: 5
  output: "out/rules_generated.yml"

# ---------------------------------------------------------------------
# COMPLETENESS / IMPUTATION STRATEGY
# ---------------------------------------------------------------------
imputation:
  detect_missing: true
  methods:
    numerical: median
    categorical: mode
    datetime: interpolate
    auto: true              # model chooses imputation strategy dynamically
  ai_support:
    enabled: true
    model_name: "microsoft/phi-2"  # small LLM for missing value inference
    confidence_threshold: 0.6
    use_contextual_cues: true

# ---------------------------------------------------------------------
# PRECISION (Semantic & Logical Validation)
# ---------------------------------------------------------------------
precision:
  enabled: true
  logic_analysis:
    detect_inconsistencies: true
    correlation_threshold: 0.85
    rule_confidence_cutoff: 0.7
  semantic_analysis:
    model_name: "sentence-transformers/all-MiniLM-L6-v2"
    detect_anomalies: true
    threshold: 0.8
  ai_support:
    enabled: true
    use_reasoning: true     # LLM suggests logical validation improvements

# ---------------------------------------------------------------------
# REUSABILITY (Semantic Harmonization)
# ---------------------------------------------------------------------
reusability:
  enabled: true
  mapping_learning:
    active: true
    approach: "few-shot semantic alignment"
    training_data: "configs/ontology_reference.json"
  ontology_alignment:
    standards: ["SNOMED", "LOINC", "ICD-10"]
    similarity_model: "huggingface/sentence-t5-base"
  auto_standardization:
    enabled: true
    feedback_loop: true     # integrates user corrections into mapping memory

# ---------------------------------------------------------------------
# QUALITY METRICS CONFIGURATION
# ---------------------------------------------------------------------
metrics:
  general:
    - name: completeness_rate
      type: not_null_rate
    - name: precision_retention
      type: logical_consistency
    - name: reusability_score
      type: entropy_based
  ai_discovery:
    enabled: true
    model: "healthdq-schema-learner"
    analyze_columns: true
    infer_metric_types: true
    output: "out/metrics_auto_generated.json"

# ---------------------------------------------------------------------
# FEEDBACK LEARNING (Human-in-the-Loop)
# ---------------------------------------------------------------------
feedback:
  enabled: true
  mode: "active_learning"
  actions:
    - confirm_rule
    - reject_rule
    - edit_rule
  save_path: "out/hitl_feedback.json"

# ---------------------------------------------------------------------
# FAIR REPRODUCIBILITY METADATA
# ---------------------------------------------------------------------
provenance:
  save_history: true
  log_file: "out/execution_log.json"
  record_pipeline_steps: true
  reproducibility_hash: true

